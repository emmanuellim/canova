{
	"AWSTemplateFormatVersion" : "2010-09-09",
	
	"Description" : "AWS CloudFormation Template for MAEStream: MAEStream is a revenue protection solution for utilities supply and distribution bodies. This template is for municipality level deployment.",
	
	"Parameters" : {
		"MunicipalityName" : {
			"Type" : "String",
			"MaxLength" : "20",
			"MinLength" : "3",
			"AllowedPattern" : "[a-z.a-z]*",
			"ConstraintDescription" : "must only contain lowercase letters and a period(.).",
			"Description" : "Name of the municipality the stack is being deployed for."
		},
		"ProvinceName" : {
			"Type" : "String",
			"MaxLength" : "2",
			"MinLength" : "2",
			"AllowedValues" : ["ns","pe","nb","qc","on","nl","mb","sk","ab","bc"],
			"ConstraintDescription" : "must only contain two uppercase letters.",
			"Description" : "Province abbreviation of the province the municipality is part of."
		}
	},
	
    "Resources" : {
        "MAESGeolocIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.geoloc.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
		}
	},
		"MAESAssetIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.asset.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESDistriRouteIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.distri.route.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESWorkOrderIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.workorder.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESFlowMeterIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.flowmeter.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESFlowReadingIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.flowreading.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESDMAIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.dma.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESAddressIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.address.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESConsumptionMeterIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.consumptionmeter.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESConsumptionReadingIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.consumptionreading.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESConsumptionReadingIngTimeSeriesBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.consumptionreading.timeseries", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESBillTimeSeriesBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.bill.timeseries", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        },
		"MAESBillingIngBucket" : {
            "Type" : "AWS::S3::Bucket",
            "Properties" : {
			"BucketName" 	: {"Fn::Join" :  [ "-", [ "maes.billing.ing", {"Ref" : "MunicipalityName"},{"Ref" : "ProvinceName"}] ]},
			"AccessControl" : "BucketOwnerFullControl",
			"BucketEncryption": {
			"ServerSideEncryptionConfiguration": [
					{
					"ServerSideEncryptionByDefault": {
					"KMSMasterKeyID" : "YOUR KMS KEY ARN",
					"SSEAlgorithm": "aws:kms"
					}
				}
			]	
			}
			}
        }
		
	},
	"Outputs" : {
		"MAESGeolocIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESGeolocIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-GeolocIng" }}
		},
		"MAESAssetIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESAssetIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-AssetIng" }}
		},
		"MAESDistriRouteIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESDistriRouteIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-DistriRouteIng" }}
		},
		"MAESWorkOrderIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESWorkOrderIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-WorkOrderIng" }}
		},
		"MAESFlowMeterIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESFlowMeterIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-FlowMeterIng" }}
		},
		"MAESFlowReadingIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESFlowReadingIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-FlowReadingIng" }}
		},
		"MAESDMAIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESDMAIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-DMAIng" }}
		},
		"MAESAddressIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESAddressIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-AddressIng" }}
		},
		"MAESConsumptionMeterIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESConsumptionMeterIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-ConsumptionMeterIng" }}
		},
		"MAESConsumptionReadingIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESConsumptionReadingIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-ConsumptionReadingIng" }}
		},
		"MAESConsumptionReadingIngTimeSeriesBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESConsumptionReadingIngTimeSeriesBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-ConsumptionReadingIngTimeSeries" }}
		},
		"MAESBillTimeSeriesBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESBillTimeSeriesBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-BillTimeSeries" }}
		},
		"MAESBillingIngBucket" : {
		"Description" : "Information about the value",
		"Value" : { "Ref" : "MAESBillingIngBucket" },
		"Export" : {"Name" : {"Fn::Sub": "${AWS::StackName}-MAESBillingIng" }}
		}
	}
}
